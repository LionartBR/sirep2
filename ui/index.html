<!DOCTYPE html>
<html lang="pt-BR">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>SIREP 2.0</title>
    <link rel="stylesheet" href="/app/css/styles.css" />
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/flatpickr/dist/flatpickr.min.css" />
  </head>
  <body>
    <header class="topbar" role="banner">
      <div class="topbar__title">SIREP 2.0</div>
      <nav class="topbar__actions" aria-label="Ações do usuário">
        <button class="topbar__action" type="button" aria-label="Perfil do usuário">
          <i data-feather="user" aria-hidden="true"></i>
        </button>
        <button class="topbar__action" type="button" aria-label="Configurações">
          <i data-feather="settings" aria-hidden="true"></i>
        </button>
        <span class="topbar__user" id="currentUserName" aria-live="polite"></span>
        <a href="/app/login.html" class="topbar__signout">Sair</a>
      </nav>
    </header>

    <main class="layout" role="main">
      <section class="card" aria-labelledby="tab-base">
        <div class="tabs" role="tablist" aria-label="Seções principais">
          <button
            class="tabs__item tabs__item--active"
            id="tab-base"
            role="tab"
            aria-selected="true"
            aria-controls="panel-base"
            tabindex="0"
          >
            Gestão da Base
          </button>
          <button
            class="tabs__item"
            id="tab-treatment"
            role="tab"
            aria-selected="false"
            aria-controls="panel-treatment"
            tabindex="-1"
          >
            Tratamento
          </button>
        </div>

        <div id="panel-base" class="card__panel" role="tabpanel" aria-labelledby="tab-base">
          <div class="controls" role="group" aria-label="Controles de execução">
            <div class="controls__group">
              <div class="controls__start">
                <div class="controls__buttons">
                  <button class="btn btn--primary" id="btnStart" type="button">Iniciar</button>
                  <button class="btn btn--ghost" id="btnPause" type="button" disabled>Pausar</button>
                  <button class="btn btn--ghost" id="btnContinue" type="button" disabled>Continuar</button>
                </div>
                <p class="controls__info" id="lastUpdateInfo" aria-live="polite"></p>
              </div>
            </div>
          </div>

          <div class="progress progress--hidden" aria-hidden="true">
            <div class="progress__bar"></div>
          </div>

          <div class="kpi-grid" role="group" aria-label="Indicadores da captura">
            <div class="kpi-card">
              <div class="kpi-row">
                <div class="kpi-left">
                  <span class="kpi-label">ESTADO</span>
                </div>
                <span class="kpi-value" id="statusText">—</span>
              </div>
            </div>
            <div class="kpi-card">
              <div class="kpi-row">
                <div class="kpi-left">
                  <span class="kpi-label">Última atualização</span>
                </div>
                <span class="kpi-value" id="lbl-last-update">—</span>
              </div>
            </div>
            <div class="kpi-card">
              <div class="kpi-row">
                <div class="kpi-left">
                  <span class="kpi-label">Duração da última atualização</span>
                </div>
                <span class="kpi-value" id="lbl-last-duration">—</span>
              </div>
            </div>
          </div>

          <div class="section-title section-title--tables">
            <div
              class="section-switch-group"
              role="tablist"
              aria-label="Listas de planos"
            >
              <button
                class="section-switch section-switch--active"
                id="plansTableTab"
                type="button"
                role="tab"
                aria-selected="true"
                aria-controls="plansTablePanel"
                data-table-target="plans"
                tabindex="0"
              >
                TABELA DE PLANOS
              </button>
              <button
                class="section-switch"
                id="occurrencesTableTab"
                type="button"
                role="tab"
                aria-selected="false"
                aria-controls="occurrencesTablePanel"
                data-table-target="occurrences"
                tabindex="-1"
              >
                OCORRÊNCIAS
                <span class="section-switch__count" id="occurrencesCount">(0)</span>
              </button>
            </div>

            <form
              class="table-search"
              id="tableSearchForm"
              role="search"
              autocomplete="off"
            >
              <label class="sr-only" for="tableSearchInput"
                >Digite o número do plano, CNPJ/CEI ou razão social…</label
              >
              <input
                class="table-search__input"
                type="search"
                id="tableSearchInput"
                name="q"
                placeholder="Digite o número do plano, CNPJ/CEI ou razão social…"
                aria-label="Digite o número do plano, CNPJ/CEI ou razão social…"
              />
              <button class="table-search__button" type="submit" aria-label="Buscar">
                <i data-feather="search" aria-hidden="true"></i>
              </button>
            </form>
          </div>

          <div
            class="table-panel"
            id="plansTablePanel"
            role="tabpanel"
            aria-labelledby="plansTableTab"
            data-table-panel="plans"
          >
            <div class="table-active-filters" id="plansFiltersChips" hidden></div>
            <div class="table">
              <table class="data-table" aria-label="Tabela de planos">
                <thead class="table__head">
                  <tr>
                    <th scope="col">PLANO</th>
                    <th scope="col">CNPJ/CPF/CEI</th>
                    <th scope="col">RAZÃO SOCIAL</th>
                    <th scope="col" class="table__col--filterable">
                      <div class="table-filter" data-filter-group="situacao">
                        <button class="table-filter__trigger" type="button" aria-expanded="false">
                          <span>SITUAÇÃO</span>
                          <i data-feather="chevron-down" class="table-filter__icon" aria-hidden="true"></i>
                        </button>
                        <div class="table-filter__dropdown" role="menu">
                          <p class="table-filter__title">Selecione as situações</p>
                          <div class="table-filter__options" role="group" aria-label="Situação">
                            <label class="table-filter__option">
                              <input type="checkbox" value="P_RESCISAO" data-filter-input="situacao" />
                              <span>P. Rescisão</span>
                            </label>
                            <label class="table-filter__option">
                              <input type="checkbox" value="SIT_ESPECIAL" data-filter-input="situacao" />
                              <span>Sit. Especial</span>
                            </label>
                            <label class="table-filter__option">
                              <input type="checkbox" value="RESCINDIDO" data-filter-input="situacao" />
                              <span>Rescindido</span>
                            </label>
                            <label class="table-filter__option">
                              <input type="checkbox" value="LIQUIDADO" data-filter-input="situacao" />
                              <span>Liquidado</span>
                            </label>
                            <label class="table-filter__option">
                              <input type="checkbox" value="GRDE_EMITIDA" data-filter-input="situacao" />
                              <span>GRDE Emitida</span>
                            </label>
                          </div>
                          <div class="table-filter__actions">
                            <button
                              type="button"
                              class="table-filter__clear"
                              data-filter-clear="situacao"
                            >
                              Limpar filtro
                            </button>
                          </div>
                        </div>
                      </div>
                    </th>
                    <th scope="col" class="table__col--filterable">
                      <div class="table-filter" data-filter-group="dias">
                        <button class="table-filter__trigger" type="button" aria-expanded="false">
                          <span>DIAS EM ATRASO</span>
                          <i data-feather="chevron-down" class="table-filter__icon" aria-hidden="true"></i>
                        </button>
                        <div class="table-filter__dropdown" role="menu">
                          <p class="table-filter__title">Selecione o mínimo</p>
                          <div class="table-filter__options" role="group" aria-label="Dias em atraso">
                            <label class="table-filter__option">
                              <input type="radio" name="filter-days" value="90" data-filter-input="dias" />
                              <span>&ge; 90 dias</span>
                            </label>
                            <label class="table-filter__option">
                              <input type="radio" name="filter-days" value="100" data-filter-input="dias" />
                              <span>&ge; 100 dias</span>
                            </label>
                            <label class="table-filter__option">
                              <input type="radio" name="filter-days" value="120" data-filter-input="dias" />
                              <span>&ge; 120 dias</span>
                            </label>
                          </div>
                          <div class="table-filter__actions">
                            <button
                              type="button"
                              class="table-filter__clear"
                              data-filter-clear="dias"
                            >
                              Limpar filtro
                            </button>
                          </div>
                        </div>
                      </div>
                    </th>
                    <th scope="col" class="table__col--filterable">
                      <div class="table-filter" data-filter-group="saldo">
                        <button class="table-filter__trigger" type="button" aria-expanded="false">
                          <span>SALDO</span>
                          <i data-feather="chevron-down" class="table-filter__icon" aria-hidden="true"></i>
                        </button>
                        <div class="table-filter__dropdown" role="menu">
                          <p class="table-filter__title">Saldo mínimo</p>
                          <div class="table-filter__options" role="group" aria-label="Saldo mínimo">
                            <label class="table-filter__option">
                              <input type="radio" name="filter-saldo" value="10000" data-filter-input="saldo" />
                              <span>R$ 10 mil+</span>
                            </label>
                            <label class="table-filter__option">
                              <input type="radio" name="filter-saldo" value="50000" data-filter-input="saldo" />
                              <span>R$ 50 mil+</span>
                            </label>
                            <label class="table-filter__option">
                              <input type="radio" name="filter-saldo" value="150000" data-filter-input="saldo" />
                              <span>R$ 150 mil+</span>
                            </label>
                            <label class="table-filter__option">
                              <input type="radio" name="filter-saldo" value="500000" data-filter-input="saldo" />
                              <span>R$ 500 mil+</span>
                            </label>
                            <label class="table-filter__option">
                              <input type="radio" name="filter-saldo" value="1000000" data-filter-input="saldo" />
                              <span>R$ 1 mi+</span>
                            </label>
                          </div>
                          <div class="table-filter__actions">
                            <button
                              type="button"
                              class="table-filter__clear"
                              data-filter-clear="saldo"
                            >
                              Limpar filtro
                            </button>
                          </div>
                        </div>
                      </div>
                    </th>
                    <th scope="col" class="table__col--filterable">
                      <div class="table-filter" data-filter-group="dt">
                        <button class="table-filter__trigger" type="button" aria-expanded="false">
                          <span>DT SITUAÇÃO</span>
                          <i data-feather="chevron-down" class="table-filter__icon" aria-hidden="true"></i>
                        </button>
                        <div class="table-filter__dropdown" role="menu">
                          <p class="table-filter__title">Intervalo de data</p>
                          <div class="table-filter__options" role="group" aria-label="Data da situação">
                            <label class="table-filter__option">
                              <input type="radio" name="filter-date" value="LAST_3_MONTHS" data-filter-input="dt" />
                              <span>&lt; 3 meses</span>
                            </label>
                            <label class="table-filter__option">
                              <input type="radio" name="filter-date" value="LAST_2_MONTHS" data-filter-input="dt" />
                              <span>&lt; 2 meses</span>
                            </label>
                            <label class="table-filter__option">
                              <input type="radio" name="filter-date" value="LAST_MONTH" data-filter-input="dt" />
                              <span>&lt; 1 mês</span>
                            </label>
                            <label class="table-filter__option">
                              <input type="radio" name="filter-date" value="THIS_MONTH" data-filter-input="dt" />
                              <span>Mês atual</span>
                            </label>
                          </div>
                          <div class="table-filter__actions">
                            <button
                              type="button"
                              class="table-filter__clear"
                              data-filter-clear="dt"
                            >
                              Limpar filtro
                            </button>
                          </div>
                        </div>
                      </div>
                    </th>
                    <th scope="col">AÇÕES</th>
                  </tr>
                </thead>
                <tbody>
                  <tr class="table__row table__row--empty">
                    <td class="table__cell" colspan="8">nada a exibir por aqui.</td>
                  </tr>
                </tbody>
              </table>
            </div>

            <div class="table-footer">
              <div class="pager-info">
                <span id="plansPagerRange" class="pager__label" aria-live="polite">exibindo 0–0 de ~0 planos</span>
              </div>
              <div class="pager" role="navigation" aria-label="Paginação">
                <button id="plansPagerPrev" class="pager__btn" type="button" aria-disabled="true" disabled>
                  <i data-feather="chevron-left" aria-hidden="true"></i>
                </button>
                <span id="plansPagerLabel" class="pager__label">pág. 1 de ?</span>
                <button id="plansPagerNext" class="pager__btn" type="button" aria-disabled="true" disabled>
                  <i data-feather="chevron-right" aria-hidden="true"></i>
                </button>
              </div>
            </div>
          </div>

          <div
            class="table-panel table-panel--hidden"
            id="occurrencesTablePanel"
            role="tabpanel"
            aria-labelledby="occurrencesTableTab"
            data-table-panel="occurrences"
            hidden
          >
            <div class="table">
              <table
                class="data-table"
                aria-label="Tabela de planos com ocorrências"
              >
                <thead class="table__head">
                  <tr>
                    <th scope="col">PLANO</th>
                    <th scope="col">CNPJ</th>
                    <th scope="col">RAZÃO SOCIAL</th>
                    <th scope="col">SITUAÇÃO</th>
                    <th scope="col">DIAS EM ATRASO</th>
                    <th scope="col">SALDO</th>
                    <th scope="col">DT SITUAÇÃO</th>
                    <th scope="col">AÇÕES</th>
                  </tr>
                </thead>
                <tbody>
                  <tr class="table__row table__row--empty">
                    <td class="table__cell" colspan="8">
                      nenhuma ocorrência por aqui.
                    </td>
                  </tr>
                </tbody>
              </table>
            </div>

            <div class="table-footer">
              <div class="pager-info">
                <span id="occPagerRange" class="pager__label" aria-live="polite">exibindo 0–0 de ~0 planos para tratamento manual</span>
              </div>
              <div class="pager" role="navigation" aria-label="Paginação de ocorrências">
                <button id="occPagerPrev" class="pager__btn" type="button" aria-disabled="true" disabled>
                  <i data-feather="chevron-left" aria-hidden="true"></i>
                </button>
                <span id="occPagerLabel" class="pager__label">pág. 1 de ?</span>
                <button id="occPagerNext" class="pager__btn" type="button" aria-disabled="true" disabled>
                  <i data-feather="chevron-right" aria-hidden="true"></i>
                </button>
              </div>
            </div>
          </div>

          <div class="accordion accordion--compact">
            <div class="accordion__header">
              <button
                class="accordion__toggle"
                id="logsToggle"
                type="button"
                aria-expanded="false"
                aria-controls="logsPanel"
              >
                <span class="accordion__toggle-icon" aria-hidden="true">
                  <i data-feather="chevron-right"></i>
                </span>
                <span class="accordion__toggle-label">Janela de Eventos (logs)</span>
              </button>
              <div
                class="logs-panel__controls"
                role="group"
                aria-labelledby="logsToggle"
              >
                <div class="filters">
                  <div class="filters__field">
                    <label class="filters__label" for="date-from">De:</label>
                    <div class="filters__input-wrapper">
                      <input
                        type="text"
                        id="date-from"
                        placeholder="dd/mm/aaaa"
                        aria-label="De"
                        readonly
                      />
                      <button
                        class="filters__icon"
                        type="button"
                        id="open-date-from"
                        aria-label="Abrir calendário de data inicial"
                      >
                        <i data-feather="calendar" aria-hidden="true"></i>
                      </button>
                    </div>
                  </div>
                  <div class="filters__field">
                    <label class="filters__label" for="date-to">Até:</label>
                    <div class="filters__input-wrapper">
                      <input
                        type="text"
                        id="date-to"
                        placeholder="dd/mm/aaaa"
                        aria-label="Até"
                        readonly
                      />
                      <button
                        class="filters__icon"
                        type="button"
                        id="open-date-to"
                        aria-label="Abrir calendário de data final"
                      >
                        <i data-feather="calendar" aria-hidden="true"></i>
                      </button>
                    </div>
                  </div>
                  <button
                    class="btn btn--ghost btn--disabled"
                    type="button"
                    disabled
                    title="Em breve"
                  >
                    Exportar (.xlsx)
                  </button>
                </div>
              </div>
            </div>
            <div class="accordion__panel" id="logsPanel" role="region" aria-labelledby="logsToggle"></div>
          </div>
        </div>

        <div
          id="panel-treatment"
          class="card__panel card__panel--hidden"
          role="tabpanel"
          aria-labelledby="tab-treatment"
          hidden
        >
          <div class="controls" role="group" aria-label="Controles de execução do Tratamento">
            <div class="controls__group">
              <div class="controls__start">
                <div class="controls__buttons">
                  <button class="btn btn--ghost" id="btnMigratePlans" type="button">Migrar planos</button>
                  <button class="btn btn--primary" id="btnStartTreatment" type="button">Iniciar</button>
                  <button class="btn btn--ghost" id="btnPauseTreatment" type="button" disabled>Pausar</button>
                  <button class="btn btn--ghost" id="btnContinueTreatment" type="button" disabled>Continuar</button>
                </div>
              </div>
            </div>
            <div class="status" id="treatmentStatusText">Estado: Ocioso</div>
          </div>

          <div class="subcard" aria-labelledby="runningPlanTitle">
            <h3 id="runningPlanTitle" class="subcard__title">PLANO EM EXECUÇÃO</h3>
            <div class="running-plan">
              <div class="running-plan__col" aria-label="Dados do plano atual">
                <div class="kv">
                  <span class="kv__label">PLANO</span>
                  <span class="kv__value" id="currentPlanNumber">—</span>
                </div>
                <div class="kv">
                  <span class="kv__label">CNPJ/CPF/CEI</span>
                  <span class="kv__value" id="currentPlanDocument">—</span>
                </div>
                <div class="kv">
                  <span class="kv__label">RAZÃO SOCIAL</span>
                  <span class="kv__value" id="currentPlanCompanyName">—</span>
                </div>
                <div class="kv">
                  <span class="kv__label">SITUAÇÃO</span>
                  <span class="kv__value" id="currentPlanStatus">—</span>
                </div>
                <div class="kv">
                  <span class="kv__label">ETAPA</span>
                  <span class="kv__value" id="currentPlanStage">—</span>
                </div>
              </div>
              <div class="running-plan__col" aria-label="Indicadores de execução">
                <div class="kpi-card" role="group" aria-label="Indicadores de execução">
                  <div class="kpi-row kpi-row--warning">
                    <span class="kpi-label">Planos na fila</span>
                    <span class="kpi-value" id="kpiQueueCount">0</span>
                  </div>
                  <div class="kpi-row kpi-row--success">
                    <span class="kpi-label">Rescindidos</span>
                    <span class="kpi-value" id="kpiRescindedCount">0</span>
                  </div>
                  <div class="kpi-row kpi-row--danger">
                    <span class="kpi-label">Falhas</span>
                    <span class="kpi-value" id="kpiFailuresCount">0</span>
                  </div>
                </div>
              </div>
            </div>
          </div>

          <div class="subcard" aria-labelledby="treatmentTableTitle">
            <div class="section-title">
              <h3 id="treatmentTableTitle" class="subcard__title">TABELA DE PLANOS</h3>
            </div>
            <div class="table">
              <table class="data-table" aria-label="Tabela de planos para tratamento">
                <thead class="table__head">
                  <tr>
                    <th scope="col">PLANO</th>
                    <th scope="col">CNPJ/CPF/CEI</th>
                    <th scope="col">RAZÃO SOCIAL</th>
                    <th scope="col">SALDO</th>
                    <th scope="col">DT SITUAÇÃO</th>
                    <th scope="col">AÇÕES</th>
                  </tr>
                </thead>
                <tbody>
                  <tr class="table__row table__row--empty">
                    <td class="table__cell" colspan="6">nada a exibir por aqui.</td>
                  </tr>
                </tbody>
              </table>
            </div>
          </div>
        </div>
      </section>
    </main>

    <footer class="footer">
      <p>Desenvolvido por:</p>
      <p>CEFGD/RJ — Recuperação de Débitos do FGTS Perante o Empregador</p>
      <p>CAIXA™ 2025</p>
    </footer>

    <script src="https://cdn.jsdelivr.net/npm/flatpickr"></script>
    <script src="https://cdn.jsdelivr.net/npm/flatpickr/dist/l10n/pt.js"></script>
    <script src="https://unpkg.com/feather-icons"></script>
    <script src="/app/js/utils.js"></script>
    <script src="/app/js/auth.js"></script>
    <script src="/app/js/app.js"></script>
  </body>
</html>
